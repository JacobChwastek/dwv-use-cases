(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{233:function(e,t,a){e.exports=a(435)},238:function(e,t,a){},258:function(e,t){},260:function(e,t){},405:function(e,t,a){},433:function(e,t,a){},435:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),r=a(16),i=a.n(r),l=(a(238),a(46)),s=a(149),c=a(69),d=a(70),u=a(75),p=a(77),h=a(200),v=a(144),m=a.n(v),g=a(201),f=a(440),w=a(47),E=a(96),b=a(441),x=a(101),S=a.n(x),C=a(56),D=a.n(C),O=a(438),y=function(e){Object(p.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).columns=[{title:"Tag",dataIndex:"name",key:"name"},{title:"Value",dataIndex:"value",key:"value"}],n.state={data:n.props.data},n}return Object(d.a)(a,[{key:"render",value:function(){var e=this.state.data;return o.a.createElement(O.a,{dataSource:e,columns:this.columns})}}]),a}(o.a.Component);a(405);D.a.gui.getElement=D.a.gui.base.getElement,D.a.image.decoderScripts={jpeg2000:"assets/dwv/decoders/pdfjs/decode-jpeg2000.js","jpeg-lossless":"assets/dwv/decoders/rii-mango/decode-jpegloss.js","jpeg-baseline":"assets/dwv/decoders/pdfjs/decode-jpegbaseline.js",rle:"assets/dwv/decoders/dwv/decode-rle.js"};var j=function(e){Object(p.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).initializeDwv=function(){var e=new D.a.App;e.init({containerDivId:"dwv",tools:n.state.tools}),n.addEventListeners(e),n.setState({dwvApp:e}),n.setupDropbox(e),D.a.utils.loadFromUri(window.location.href,e)},n.addEventListeners=function(e){var t=null,a=null;e.addEventListener("load-start",(function(){t=0,a=0})),e.addEventListener("load-progress",(function(e){n.setState({loadProgress:e.loaded})})),e.addEventListener("load",(function(){n.setState({metaData:D.a.utils.objectToArray(e.getMetaData())});var t="Scroll";e.isMonoSliceData()&&1===e.getImage().getNumberOfFrames()&&(t="ZoomAndPan"),n.onChangeTool(t),n.hideDropbox(),n.setState({dataLoaded:!0})})),e.addEventListener("load-end",(function(){t&&(n.setState({loadProgress:0}),alert("Received errors during load. Check log for details.")),a&&(n.setState({loadProgress:0}),alert("Load was aborted.")),n.setState({loadProgress:100},(function(){n.props.handleDicomLoadedState(!0)}))})),e.addEventListener("frame-change",(function(e){n.setState({frame:e.frame})})),e.addEventListener("error",(function(e){console.error(e.error),++t})),e.addEventListener("abort",(function(){++a})),e.addEventListener("keydown",(function(t){e.defaultOnKeydown(t)})),e.addEventListener("draw-move",(function(){n.updateDrawingState()})),e.addEventListener("draw-change",(function(){n.updateDrawingState()})),e.addEventListener("draw-create",(function(e){n.updateDrawingState("add",e.id)})),e.addEventListener("draw-delete",(function(e){n.updateDrawingState("delete",e.id)})),window.addEventListener("resize",e.onResize)},n.updateDrawingState=Object(g.a)(m.a.mark((function e(){var t,a,o,r,i,l,s=arguments;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=s.length>0&&void 0!==s[0]?s[0]:null,a=s.length>1&&void 0!==s[1]?s[1]:null,!(o=n.state.dwvApp)){e.next=14;break}return r=new D.a.State,i=r.toJSON(o),l=JSON.parse(i),e.next=9,n.props.onStateChange;case 9:if(e.t0=e.sent,!e.t0){e.next=12;break}n.props.onStateChange(l);case 12:"add"===t&&n.props.addNewShape&&n.props.addNewShape(a),"delete"===t&&n.props.addNewShape&&n.props.deleteShape(a);case 14:case"end":return e.stop()}}),e)}))),n.getFramesNumberOfDicom=function(){var e=n.state.metaData;if(e){var t=e.find((function(e){return"NumberOfFrames"===e.name})),a=t&&t.value;return a&&parseInt(a)-1}},n.removeDrawings=function(){n.state.dwvApp.deleteDraws(),n.props.handleReset&&n.props.handleReset(!1)},n.onChangeTool=function(e){var t=n.state,a=t.dwvApp,o=t.tools.Draw.options;a&&(n.setState({selectedTool:e}),a.setTool(e),"Draw"===e&&n.onChangeShape(o[0]))},n.onChangeShape=function(e){var t=n.state.dwvApp;t&&t.setDrawShape(e)},n.handleTagsDialogOpen=function(){n.setState({showDicomTags:!0})},n.handleTagsDialogClose=function(){n.setState({showDicomTags:!1})},n.setupDropbox=function(e){var t=e.getElement("layerContainer");t&&(t.addEventListener("dragover",n.onDragOver),t.addEventListener("dragleave",n.onDragLeave),t.addEventListener("drop",n.onDrop));var a=e.getElement(n.state.dropboxClassName);if(a){var o=2*e.getLayerContainerSize().height/3;a.setAttribute("style","width:"+o+"px;height:"+o+"px")}},n.onDragOver=function(e){var t=n.state,a=t.dwvApp,o=t.borderClassName,r=t.hoverClassName;e.stopPropagation(),e.preventDefault();var i=a.getElement(o);i&&-1===i.className.indexOf(r)&&(i.className+=" "+r)},n.onDragLeave=function(e){var t=n.state,a=t.dwvApp,o=t.hoverClassName;e.stopPropagation(),e.preventDefault();var r=a.getElement(n.borderClassName+" hover");r&&-1!==r.className.indexOf(o)&&(r.className=r.className.replace(" "+o,""))},n.hideDropbox=function(){var e=n.state,t=e.dwvApp,a=e.dropboxClassName,o=t.getElement(a);o&&o.parentNode.removeChild(o)},n.onDrop=function(e){var t=n.state.dwvApp;e.stopPropagation(),e.preventDefault(),t.loadFiles(e.dataTransfer.files),n.hideDropbox()},n.drawCircle=function(){var e=n.state,t=e.dwvApp,a=e.loadProgress,o=e.dataLoaded,r=n.props.circle,i=r.center,l=i.x,s=i.y,c=r.r;if(t&&o&&100===a){var d=new D.a.math.Point2D(l,s),u=new D.a.math.Point2D(l+c,s+c),p=new D.a.tool.draw.EllipseFactory.prototype.create([d,u],t.getStyle(),t.getImage()),h=t.getDrawController().getDrawLayer();h.add(p),h.draw()}},n.updatePropsParams=function(){n.state.metaData.forEach((function(e){"0x0018"===e.group&&e.element,"0x0018"===e.group&&e.element,"0x0028"===e.group&&"0x0030"===e.element&&n.props.handlePixelSpacing&&n.props.handlePixelSpacing(e.value)}))},n.onCanvasClick=function(e){var t=n.state.dwvApp,a=t.getImageLayer(),o=t.getImageData(),r=o.width,i=o.height,l=a.getCanvas(),s=r/l.width,c=i/l.height,d=(e.clientX-e.target.getBoundingClientRect().left)*s,u=(e.clientY-e.target.getBoundingClientRect().top)*c;n.props.addPoint&&n.props.addPoint(d,u)},n.state={tools:{Draw:{options:["Ellipse"],type:"factory",events:["draw-create","draw-change","draw-move","draw-delete"]},ZoomAndPan:{}},selectedTool:"Select Tool",loadProgress:0,dataLoaded:!1,dwvApp:null,metaData:[],showDicomTags:!1,dropboxClassName:"dropBox",borderClassName:"dropBoxBorder",hoverClassName:"hover",frame:0},n}return Object(d.a)(a,[{key:"componentDidMount",value:function(){this.initializeDwv()}},{key:"componentDidUpdate",value:function(e){if(this.props.dicom!==e.dicom&&null!==this.props.dicom){var t=[this.props.dicom];this.state.dwvApp.loadFiles(t)}this.props.selectedTool!==e.selectedTool&&this.onChangeTool(this.props.selectedTool),this.props.hasPixelSpacing||this.updatePropsParams(),this.props.draw&&this.drawCircle(),this.props.reset&&(console.log("xd"),this.removeDrawings())}},{key:"render",value:function(){var e=this,t=this.state,a=t.loadProgress,n=t.dataLoaded,r=t.metaData,i=t.selectedTool,l=t.showDicomTags;return o.a.createElement("div",{id:"dwv"},o.a.createElement(f.a,{percent:a}),o.a.createElement(w.a,{onClick:this.handleTagsDialogOpen,disabled:!n},"Tagi DICOM"),"Draw"===i&&o.a.createElement(E.a,null,"Dodawanie / Edycja artefaktu..."),o.a.createElement(b.a,{visible:l,onCancel:this.handleTagsDialogClose,width:1e3,footer:null},o.a.createElement(y,{data:r})),o.a.createElement("div",{className:"layerContainer"},o.a.createElement("div",{className:"dropBox dropBoxBorder"},"Przeci\u0105gnij i upu\u015b\u0107 tutaj"),o.a.createElement("canvas",Object(h.a)({className:"imageLayer",onClick:this.calculateClickPosition},"onClick",(function(t){return e.onCanvasClick(t)})),"Only for HTML5 compatible browsers..."),o.a.createElement("div",{className:"drawDiv"})),this.getFramesNumberOfDicom()&&"Frame: ".concat(this.state.frame," / ").concat(this.getFramesNumberOfDicom()))}}]),a}(o.a.Component),P=a(227),L=a(106),k=a(57),N=a(442),A=a(439),T=a(44);function R(){var e=Object(l.a)(["\n    width: 100%;\n    height: 100%;\n\n    .ant-card-head {\n        border-bottom: 0px;\n    }\n\n    .ant-card-body {\n        padding-top: 0px;\n    }\n\n    .ant-card-head-title {\n        color: #55595d;\n    }\n"]);return R=function(){return e},e}var B=Object(T.a)(A.a)(R()),F=function(e){return o.a.createElement(B,{title:null===e||void 0===e?void 0:e.title,bordered:null===e||void 0===e?void 0:e.bordered},null===e||void 0===e?void 0:e.children)},M=a(443);function z(){var e=Object(l.a)(["\n    display: flex;\n    flex-direction: row;\n"]);return z=function(){return e},e}function I(){var e=Object(l.a)(["\n    width: 100%;\n"]);return I=function(){return e},e}var V=L.a.Option,W=Object(T.a)(L.a)(I()),J=T.a.div(z()),K=function(e){return o.a.createElement(J,null,o.a.createElement(W,{value:null===e||void 0===e?void 0:e.selectedOption,onChange:function(t){return e.onChange(t)},disabled:null===e||void 0===e?void 0:e.disabled,placeholder:null===e||void 0===e?void 0:e.placeholder},e.options&&e.options.map((function(e){return o.a.createElement(V,{key:e.value,value:e.value},e.label)}))),o.a.createElement(w.a,{icon:o.a.createElement(M.a,null),onClick:function(){b.a.info({title:null===e||void 0===e?void 0:e.title,content:null===e||void 0===e?void 0:e.infoContent,onOk:function(){}})}}))},U=a(126);var $=function(e){Object(p.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(e=t.call.apply(t,[this].concat(o))).onChange=function(t){var a=t.target.value;(!isNaN(a)&&/^-?\d*(\.\d*)?$/.test(a)||""===a||"-"===a)&&e.props.onChange(a)},e.onBlur=function(){var t=e.props,a=t.value,n=t.onBlur,o=t.onChange;if(S.a.isString(a)){var r=a;"."!==a.charAt(a.length-1)&&"-"!==a||(r=a.slice(0,-1)),o(r.replace(/0*(\d+)/,"$1")),n&&n()}},e}return Object(d.a)(a,[{key:"render",value:function(){var e,t,a,n,r,i=this.props.value,l=i?o.a.createElement("span",{className:"numeric-input-title"},"-"!==i?function(e){var t=(e+="").split("."),a="-"===t[0].charAt(0)?"-":"",n=a?t[0].slice(1):t[0],o="";for(;n.length>3;)o=",".concat(n.slice(-3)).concat(o),n=n.slice(0,n.length-3);n&&(o=n+o);return"".concat(a).concat(o).concat(t[1]?".".concat(t[1]):"")}(i):"-"):null===(e=this.props)||void 0===e?void 0:e.tooltipText;return o.a.createElement(U.a,{trigger:["focus"],title:l,visible:null===(t=this.props)||void 0===t?void 0:t.tooltip,placement:"topLeft",overlayClassName:"numeric-input"},o.a.createElement(N.a,{defaultValue:null===(a=this.props)||void 0===a?void 0:a.defaultValue,disabled:null===(n=this.props)||void 0===n?void 0:n.disabled,onChange:this.onChange,onBlur:this.onBlur,value:"".concat(this.props.value),placeholder:null===(r=this.props)||void 0===r?void 0:r.placeholder,maxLength:25}))}}]),a}(n.Component),Z=function(e,t){return t&&e>0?e*q(t)/10:e},q=function(e){return S.a.isString(e)?parseFloat(e&&e.split("\\")[0]):e};function G(){var e=Object(l.a)(["\n    width: 100%;\n"]);return G=function(){return e},e}function H(){var e=Object(l.a)(["\n    width: 100% !important;\n"]);return H=function(){return e},e}function X(){var e=Object(l.a)(["\n    width: 60%;\n"]);return X=function(){return e},e}function Y(){var e=Object(l.a)(["\n    display: flex !important;\n    flex-direction: row;\n"]);return Y=function(){return e},e}var Q=L.a.Option,_=Object(T.a)(N.a.Group)(Y()),ee=Object(T.a)(L.a)(X()),te=(Object(T.a)(N.a)(H()),Object(T.a)(w.a)(G())),ae=function(e){var t,a=Object(n.useState)("px"),r=Object(P.a)(a,2),i=r[0],l=r[1],s=function(t){var a=parseFloat(t);if("cm"===i){var n=function(e,t){return t&&e>0?10*e/q(t):e}(a,e.pixelSpacing);e.handleRadiusChange(n)}else e.handleRadiusChange(a||0)};return o.a.createElement("div",null,o.a.createElement(E.a,{gutter:[16,16]},o.a.createElement(k.a,{span:24},o.a.createElement(_,{compact:!0},o.a.createElement($,{disabled:1===e.points.length,defaultValue:0,value:(t=e.radius,"cm"===i?Z(t,e.pixelSpacing):t),onChange:function(e){return s(e)}}),o.a.createElement(ee,{defaultValue:"px",value:i,onChange:function(t){return function(t){e.handleRadiusChange(0),l(t)}(t)}},o.a.createElement(Q,{value:"cm"},"cm"),o.a.createElement(Q,{value:"px"},"px"))))),o.a.createElement(E.a,{gutter:[16,16]},o.a.createElement(k.a,{span:12},1===e.points.length?o.a.createElement(te,{onClick:function(){return e.handleReset(!0)}},"Resetuj"):o.a.createElement(te,{onClick:function(){return e.handlePointsButton(!0)}}," Wyznacz \u015brodek")),o.a.createElement(k.a,{span:12},e.points.length," / 1")))},ne=a(444);function oe(){var e=Object(l.a)(["\n    width: 100%;\n"]);return oe=function(){return e},e}function re(){var e=Object(l.a)(["\n\n"]);return re=function(){return e},e}var ie=T.a.div(re()),le=Object(T.a)(w.a)(oe()),se=function(e){var t=e.circle,a=t.center,n=t.r,r=t.pixelSpacing;return o.a.createElement(ie,null,o.a.createElement(E.a,{gutter:[16,16]},o.a.createElement(k.a,{span:12},3===e.points.length?o.a.createElement(le,{onClick:function(){return e.handleReset(!0)}},"Resetuj"):o.a.createElement(le,{onClick:function(){return e.handlePointsButton(!0)}}," Wyznacz punkty")),o.a.createElement(k.a,{span:12},e.points.length," / 3")),3===e.points.length&&o.a.createElement(o.a.Fragment,null,o.a.createElement(E.a,{gutter:[16,16]},o.a.createElement(k.a,{span:24},o.a.createElement(ne.a,{title:"\u015arodek",value:"[ ".concat(a.x.toFixed(3),", ").concat(a.y.toFixed(3)," ]")}))),o.a.createElement(E.a,{gutter:[16,16]},o.a.createElement(k.a,{span:24},o.a.createElement(ne.a,{title:"Promie\u0144",suffix:"px",value:n.toFixed(3)}))),o.a.createElement(E.a,{gutter:[16,16]},o.a.createElement(k.a,{span:24},o.a.createElement(ne.a,{title:"Promie\u0144",suffix:"cm",value:Z(n,r).toFixed(3)})))))};function ce(){var e=Object(l.a)(["\n    padding: 50px;\n"]);return ce=function(){return e},e}var de=function(e){Object(p.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).handleDicomLoadedState=function(e){n.setState({isDicomLoaded:e})},n.handlePixelSpacing=function(e){var t=parseFloat(e.split("\\")[0]);n.setState({pixelSpacing:t})},n.handleDraw=function(e){n.setState({draw:e})},n.handleOptionChange=function(e){1===e?n.setState({menuOption:"3point"}):2==e&&n.setState({menuOption:"1pointcenter"}),n.setState({option:e})},n.handleRadiusChange=function(e){n.setState({radius:e})},n.handleReset=function(e){e&&n.setState({points:[],radius:0}),n.setState({reset:e})},n.handlePointsButton=function(e){n.setState({canChoosePoints:e})},n.action=function(){var e=n.state,t=e.option,a=e.points,r=e.circle,i=e.radius,l=e.pixelSpacing;switch(t){case 1:return o.a.createElement(se,{handlePointsButton:n.handlePointsButton,points:a,circle:r,handleReset:n.handleReset});case 2:return o.a.createElement(ae,{handlePointsButton:n.handlePointsButton,points:a,circle:r,pixelSpacing:l,handleReset:n.handleReset,handleRadiusChange:n.handleRadiusChange,radius:i});default:return o.a.createElement(o.a.Fragment,null)}},n.handleAddPoint=function(e,t){var a=n.state,o=a.points,r=a.canChoosePoints,i=a.menuOption,l=a.pixelSpacing,c={x:e,y:t};switch(i){case"3point":o.length<3&&r&&n.setState({points:[].concat(Object(s.a)(o),[c])},(function(){if(3===n.state.points.length){var e=function(e,t,a){var n=e.x-t.x,o=e.x-a.x,r=e.y-t.y,i=e.y-a.y,l=a.y-e.y,s=t.y-e.y,c=a.x-e.x,d=t.x-e.x,u=Math.pow(e.x,2)-Math.pow(a.x,2),p=Math.pow(e.y,2)-Math.pow(a.y,2),h=Math.pow(t.x,2)-Math.pow(e.x,2),v=Math.pow(t.y,2)-Math.pow(e.y,2),m=(u*n+p*n+h*o+v*o)/(2*(l*n-s*o)),g=(u*r+p*r+h*i+v*i)/(2*(c*r-d*i)),f=-1*g,w=-1*m,E=f*f+w*w-(-Math.pow(e.x,2)-Math.pow(e.y,2)-2*g*e.x-2*m*e.y);return{center:{x:f+0,y:w+0},r:Math.sqrt(E),pixelSpacing:0}}(n.state.points[0],n.state.points[1],n.state.points[2]);e.pixelSpacing=l,n.setState({draw:!0,circle:e,canChoosePoints:!1},(function(){return n.handleDraw(!1)}))}}));break;case"1pointcenter":if(o.length<1&&r){var d=n.state.radius;n.setState({points:[].concat(Object(s.a)(o),[c])},(function(){if(1===n.state.points.length){var e={center:{x:c.x,y:c.y},r:d,pixelSpacing:l};n.setState({draw:!0,circle:e,canChoosePoints:!1},(function(){return n.handleDraw(!1)}))}}))}}},n.options=[{label:"Ko\u0142o na podstawie trzech punkt\xf3w",value:1},{label:"Ko\u0142o \u015brodek, promie\u0144",value:2}],n.state={isDicomLoaded:!1,option:0,draw:!1,points:[],circle:{center:{x:0,y:0},r:0,pixelSpacing:0},canChoosePoints:!1,reset:!1,menuOption:null,radius:0,pixelSpacing:0},n}return Object(d.a)(a,[{key:"render",value:function(){var e=this,t=this.state,a=t.isDicomLoaded,n=t.draw,r=t.circle,i=t.reset,l=t.pixelSpacing;return o.a.createElement(ue,null,o.a.createElement(E.a,{gutter:[16,16]},o.a.createElement(k.a,{span:6},o.a.createElement(F,{title:"Konfiguruj"},o.a.createElement(o.a.Fragment,null,o.a.createElement(E.a,{gutter:[16,16]},o.a.createElement(k.a,{span:24},o.a.createElement(K,{options:this.options,onChange:function(t){return e.handleOptionChange(t)},placeholder:"Wybierz opcj\u0119",disabled:!a,title:"Uwaga!",infoContent:o.a.createElement(o.a.Fragment,null,"Aby m\xf3\u0107 wybra\u0107 opcj\u0119 wgraj plik DIcom")}))),this.action()))),o.a.createElement(k.a,{span:12},o.a.createElement(j,{handleDicomLoadedState:this.handleDicomLoadedState,handleReset:this.handleReset,handlePixelSpacing:this.handlePixelSpacing,draw:n,reset:i,handleDraw:this.handleDraw,addPoint:this.handleAddPoint,circle:r,hasPixelSpacing:Boolean(l)})),o.a.createElement(k.a,{span:6})))}}]),a}(n.Component),ue=T.a.div(ce()),pe=de;a(433),a(434);var he=function(){return o.a.createElement("div",{className:"App"},o.a.createElement(pe,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(he,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[233,1,2]]]);
//# sourceMappingURL=main.1d784ad1.chunk.js.map